<!doctype html>
<html ‚ö° lang="en" prefix="og: http://ogp.me/ns#">
<head>
  <meta charset="utf-8">
  <meta name="theme-color" content="#ffffff"/>
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
  <meta name="msvalidate.01" content="C02D47D34B2CA730AA994096C315F5FE" />
  <meta name="description" content="And body is not setNeedsLayout.">

  <link rel="manifest" href="/manifest.json">

  
  

  <!-- define the title tag -->
<title>
  
    SwiftUI: View is not UIView
  
</title>


  
    <link rel="canonical" href="https://haoluo.io/posts/swiftui-viewbody" />
    <link rel="alternate" media="handheld" href="https://haoluo.io/posts/swiftui-viewbody" />
  

  <!-- favicons -->
<link rel="apple-touch-icon-precomposed" sizes="57x57" href="/assets/favicons/apple-touch-icon-57x57.png" />
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/assets/favicons/apple-touch-icon-114x114.png" />
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/assets/favicons/apple-touch-icon-72x72.png" />
<link rel="apple-touch-icon-precomposed" sizes="60x60" href="/assets/favicons/apple-touch-icon-60x60.png" />
<link rel="apple-touch-icon-precomposed" sizes="120x120" href="/assets/favicons/apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon-precomposed" sizes="192x192" href="/assets/favicons/apple-touch-icon-192x192.png" />
<link rel="apple-touch-icon-precomposed" sizes="512x512" href="/assets/favicons/apple-touch-icon-512x512.png" />
<link rel="apple-touch-icon-precomposed" sizes="76x76" href="/assets/favicons/apple-touch-icon-76x76.png" />
<link rel="icon" type="image/png" href="/assets/favicons/favicon-96x96.png" sizes="96x96" />
<link rel="icon" type="image/png" href="/assets/favicons/favicon-32x32.png" sizes="32x32" />
<link rel="icon" type="image/png" href="/assets/favicons/favicon-16x16.png" sizes="16x16" />
<link rel="icon" type="image/png" href="/assets/favicons/favicon-128.png" sizes="128x128" />
<meta name="msapplication-square70x70logo" content="/assets/favicons/mstile-70x70.png" />

  <!-- feed link -->
  <link type="application/atom+xml" rel="alternate" href="https://haoluo.io/feed.xml" title="Articles by Hao Luo">

  
    <link href="https://fonts.googleapis.com/css?family=Cormorant+Garamond:700|Lato:300,400,700" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">
    
      <style amp-custom="" type="text/css">/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15; /* @alternate */ ;-webkit-text-size-adjust:100%}body{margin:0}main{display:block}h1{font-size:2em;margin:.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline; /* @alternate */ ;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{ /* @alternate */ ;-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{ /* @alternate */ ;-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{ /* @alternate */ ;-webkit-appearance:none}::-webkit-file-upload-button{ /* @alternate */ ;-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}template{display:none}[hidden]{display:none}#iubenda-cs-banner{bottom:0px;left:0px;position:fixed;width:100%;z-index:99999998;background-color:black}.iubenda-cs-content{display:block;margin:0 auto;padding:20px;width:auto;font-family:Helvetica, Arial, FreeSans, sans-serif;font-size:14px;background:#000;color:#fff}.iubenda-cs-rationale{max-width:900px;position:relative;margin:0 auto}.iubenda-banner-content>p{font-family:Helvetica, Arial, FreeSans, sans-serif;line-height:1.5}.iubenda-cs-close-btn{margin:0;color:#fff;text-decoration:none;font-size:14px;position:absolute;top:0;right:0;border:none}.iubenda-cs-cookie-policy-lnk{text-decoration:underline;color:#fff;font-size:14px;font-weight:900}.resp-container{position:relative;overflow:hidden;padding-top:100%}.resp-iframe{position:absolute;top:0;left:0;width:100%;height:100%;border:0}*,*::before,*::after{box-sizing:border-box}html{font-size:17px}body{margin:0 auto;font-family:-apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif; /* @alternate */ ;-webkit-font-smoothing:antialiased;font-weight:400;line-height:1.7;color:#1a1a1a;background:#fff;min-height:100vh;display:flex;flex-direction:column}main{flex:1;display:flex;flex-direction:column}p{margin:0;font-weight:400}b,strong{font-weight:600}h1,h2,h3,h4,h5,h6{margin:0;line-height:1.5;text-rendering:optimizeLegibility}h1{font-size:30.6px;font-weight:600;letter-spacing:-.02em;color:#1a1a1a}h2{font-size:24.65px;font-weight:600;color:#1a1a1a}h3{font-size:21.25px;font-weight:600}h4{font-size:18.7px;font-weight:600}h5{font-size:19.89px;font-weight:500}h6{font-size:17px}@media all and (max-width: 767px){h1{font-size:25.5px}h2{font-size:22.95px}h3{font-size:21.25px}}a{color:#1a1a1a;text-decoration:underline; /* @alternate */ ;-webkit-text-decoration-color:#1a1a1a;text-decoration-color:#1a1a1a;transition:color 0.2s linear}a:hover,a:active{color:#777}a:focus{color:#777;outline:none}ul,ol{padding-left:40px;margin:0}abbr{cursor:help;border-bottom:1px dotted #ddd}blockquote{padding:0 0 0 15px;font-family:-apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;font-size:17px;line-height:1.6;color:#999;font-style:italic;border-left:1px solid #999}hr{margin:0;border-top:0;border-right:0;border-bottom:1px solid #ddd;border-left:0}img{display:block;max-width:100%;max-height:500px;margin:0;margin-left:auto;margin-right:auto}img+em{text-align:center;display:block;font-size:14.45px;margin:-16px auto}figure .image{width:100%}figure.post{text-align:center;display:table;max-width:100%;margin:20px auto}figcaption.post{display:block;font-size:14.45px;font-style:italic;margin-top:-16px}figure.photo{text-align:center;display:table;max-width:100%;margin:80px auto 100px auto}figcaption.photo{display:block;color:#000;font-size:19.04px;font-family:-apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;margin-top:4px}::-moz-selection{color:#fff;background-color:#1a1a1a}::selection{color:#fff;background-color:#1a1a1a}.text-center{text-align:center}.clearfix:after{content:" ";visibility:hidden;display:block;height:0;clear:both}.desaturate{filter:gray;filter:grayscale(100%)}.no-text-decoration{text-decoration:none}.pace{ /* @alternate */ ;-webkit-pointer-events:none;pointer-events:none; /* @alternate */ ;-ms-user-select:none; /* @alternate */ ;-webkit-user-select:none; /* @alternate */ ;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#000000;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:1px}.notfound-wrapper{margin-top:100px;margin-bottom:100px;text-align:center}.highlight{padding:10px 50px 10px 50px}@media all and (max-width: 767px){.highlight{padding:10px 20px 10px 20px}}table{border-collapse:collapse;width:100%;table-layout:fixed;border:1px solid #999;margin-bottom:24px}table th{padding:3px 10px;background-color:white;border:1px solid #999}table td{border:1px solid #999;padding:3px 10px}.coffee-kudo{margin-top:4px}.home-container{display:block;max-width:520px}.home-text-container{font-family:-apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;color:#000}.home-text-container p{margin-bottom:10px}.menu-list{margin:20px 0;padding-left:0;list-style:square inside}.menu-list li{padding:4px 0}li.menu-list-item a{font-weight:400;font-size:1.2em;font-family:-apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;line-height:1.33333em;color:#1a1a1a}a:hover .emoji-hover{opacity:1}.emoji-hover{display:inline-block;vertical-align:middle;opacity:0;transition:opacity 0.2s linear;margin-left:10px}.footer{display:block;width:100%;text-align:center;padding:40px 0;margin-top:auto;font-family:-apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif}.footer p{font-size:12px;color:#1a1a1a}.footer a{text-decoration:underline; /* @alternate */ ;-webkit-text-decoration-color:#1a1a1a;text-decoration-color:#1a1a1a;color:#1a1a1a}.footer a:hover{color:#777}.footer-links{float:none;display:block;text-align:center;padding:0;margin:0 0 8px 0;list-style:none}.footer-links li{display:inline-block;margin:0 10px;vertical-align:middle}.footer-links li a{font-size:18px;color:#555;fill:#555}.footer-links li a:hover{color:#000;fill:#000}@media all and (max-width: 520px){.footer-links li{margin:0 10px}.footer-links li:last-child{margin-right:0}}.icon-freecodecamp{padding-top:4px}.grid-wrapper{min-height:100%;display:grid;grid-template-rows:auto 1fr auto}.grid{display:block;padding:0;margin:0 -24px;font-size:0;text-align:left}.grid-cell{display:inline-block;width:100%;padding:0 24px;margin:0;font-size:17px;text-align:left;vertical-align:top}.grid-cell.with-1col{width:8.3333333333%}.grid-cell.with-2col{width:16.6666666667%}.grid-cell.with-3col{width:25%}.grid-cell.with-4col{width:33.3333333333%}.grid-cell.with-5col{width:41.6666666667%}.grid-cell.with-6col{width:50%}.grid-cell.with-7col{width:58.3333333333%}.grid-cell.with-8col{width:66.6666666667%}.grid-cell.with-9col{width:75%}.grid-cell.with-10col{width:83.3333333333%}.grid-cell.with-11col{width:91.6666666667%}.grid-cell.with-1off{margin-left:8.3333333333%}.grid-cell.with-2off{margin-left:16.6666666667%}.grid-cell.with-3off{margin-left:25%}.grid-cell.with-4off{margin-left:33.3333333333%}.grid-cell.with-5off{margin-left:41.6666666667%}.grid-cell.with-6off{margin-left:50%}.grid-cell.with-7off{margin-left:58.3333333333%}.grid-cell.with-8off{margin-left:66.6666666667%}.grid-cell.with-9off{margin-left:75%}.grid-cell.with-10off{margin-left:83.3333333333%}.grid-cell.with-11off{margin-left:91.6666666667%}.grid-cell.is-centered{text-align:center}.grid-cell.is-right{text-align:right}.grid-cell.is-top{vertical-align:top}.grid-cell.is-middle{vertical-align:middle}.grid-cell.is-bottom{vertical-align:bottom}.default-grid-centered{max-width:720px;margin-left:auto;margin-right:auto}.home-grid-centered{max-width:720px;margin:40px auto}@media all and (max-width: 767px){.grid-cell.with-1col{width:100%}.grid-cell.with-1off{margin-left:0}.grid-cell.with-2col{width:100%}.grid-cell.with-2off{margin-left:0}.grid-cell.with-3col{width:100%}.grid-cell.with-3off{margin-left:0}.grid-cell.with-4col{width:100%}.grid-cell.with-4off{margin-left:0}.grid-cell.with-5col{width:100%}.grid-cell.with-5off{margin-left:0}.grid-cell.with-6col{width:100%}.grid-cell.with-6off{margin-left:0}.grid-cell.with-7col{width:100%}.grid-cell.with-7off{margin-left:0}.grid-cell.with-8col{width:100%}.grid-cell.with-8off{margin-left:0}.grid-cell.with-9col{width:100%}.grid-cell.with-9off{margin-left:0}.grid-cell.with-10col{width:100%}.grid-cell.with-10off{margin-left:0}.grid-cell.with-11col{width:100%}.grid-cell.with-11off{margin-left:0}.default-grid-centered{max-width:100%;margin-left:auto;margin-right:auto}.home-grid-centered{max-width:100%;margin:0 auto auto auto}}.about{padding:100px 0}.about h1{margin:50px 0 15px}.technology-list-ul{padding:0;border-left:1px solid #eaeaea;width:100%;margin:24px 0 0 0;vertical-align:baseline;position:relative}.technology-list-li{vertical-align:baseline;position:relative;margin:0;padding:0;list-style:none;display:block;float:left;border:1px solid #eaeaea;width:20%; /* @alternate */ ;text-align:-webkit-match-parent}.technology-list-a-svg{content:'';width:100%;height:0;padding:100% 0 0 0;display:block;color:#282828;text-decoration:none;vertical-align:baseline;position:relative}.technology-list-a-svg svg{position:absolute;top:35%;left:25%;width:50%;height:30%;opacity:0.5;transition:all 0.3s;box-sizing:inherit}.article{display:block;margin:80px 0}h5.artical-list-title{display:block;margin-top:60px;font-size:1.8em}.article-list{display:block;padding:0;margin:40px 0;list-style:none}.article-list li{position:relative;display:block;padding:24px 0;border-bottom:1px solid #ddd}.article-list li:last-child{border-bottom:0}.article-list li.article-pagination{display:table;width:100%;margin-top:-15px}.article-list li.article-pagination a{display:inline-block;padding-top:6px;font-size:11px;font-weight:600;letter-spacing:.1em;color:#666;text-decoration:none;text-transform:uppercase;transition:color 0.2s linear}.article-list li.article-pagination a .icon{display:inline-block;margin-top:-2px;font-size:20px;vertical-align:middle}.article-list li.article-pagination a:hover{color:#1a1a1a}.article-list-item a{text-decoration:none;display:block;transition:transform 0.2s ease}.article-list-item a:hover{transform:translateZ(0) scale(1.005)}.article-list-item a h5{position:relative;display:block;padding-right:25px;color:#1a1a1a;border-bottom:1px solid transparent;transition:color 0.2s ease}.article-list-item a h5 .icon{display:inline-block;margin-top:-2px;vertical-align:middle;opacity:0;transition:opacity 0.2s linear}.article-list-item a:hover h5{color:#777}.article-list-item a:hover h5 .icon{opacity:1}.article-list-item p{display:block;margin:12px 0 10px;font-size:15px;color:#777}.article-list-footer{display:block}.article-list-footer span,.article-list-footer a{display:inline-block;font-size:12px;color:#777;text-transform:uppercase;vertical-align:middle}.article-list-footer a{color:#777}.article-list-footer a:hover{color:#1a1a1a}.article-list-footer .article-list-tags a{margin-right:4px}.article-list-footer .article-list-tags a:last-child{margin-right:0}.article-list-divider{display:none}.article-list-tags{display:inline-block;vertical-align:top;margin-left:15px}.article-empty{display:block;margin:100px 0;font-style:italic;color:#999;text-align:center}.article-pagination-right{float:right}.article-header{display:block;padding-bottom:30px;margin-bottom:30px;border-bottom:1px solid #ddd}.article-header h1{font-family:-apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;font-weight:700;font-size:34px;letter-spacing:-0.02em}.article-header p{display:block;margin:12px 0 10px;font-size:17px;color:#777}.article-header a{text-decoration:none}.language-switch{display:block;margin-top:16px;margin-bottom:4px}.language-switch-button{display:inline-flex;align-items:center;gap:6px;padding:6px 12px;font-size:13px;font-weight:500;color:#777;background:transparent;border:1px solid #ddd;border-radius:4px;text-decoration:none;transition:all 0.2s ease}.language-switch-button:hover{color:#1a1a1a;border-color:#1a1a1a;background:rgba(221,221,221,0.1)}.language-switch-button .language-icon{width:14px;height:14px;opacity:0.7;transition:opacity 0.2s ease}.language-switch-button:hover .language-icon{opacity:1}.language-switch-button span{line-height:1}.article-content{display:block}.article-content p,.article-content ul,.article-content ol,.article-content img,.article-content blockquote{display:block;margin-top:1.5rem;margin-bottom:1.5rem;margin-left:auto}.article-content h2,.article-content h3,.article-content h4{margin-top:3rem;margin-bottom:1.5rem;letter-spacing:-0.04em;line-height:1.5rem;color:#1a1a1a;font-weight:400}.article-content blockquote p{margin-bottom:0}.article-content img.emoji{display:inline-block;margin-top:-4px;margin-bottom:0;vertical-align:middle}.article-comments{display:block;padding-top:20px;margin-top:30px;border-top:1px solid #ddd}.article-share{display:block;margin-top:-4px}.article-share a{display:inline-block;margin-right:12px;vertical-align:middle}.article-share a i{vertical-align:middle;transition:fill 0.2s linear;fill:#999;width:20px}.article-share a:hover i{fill:#555}.archive-container{display:block;margin:40px 0}h1+.archive-container{margin-top:0}.archive-year-section{display:block;margin-bottom:40px}.archive-year-section:last-child{margin-bottom:0}.archive-year-header{font-size:24px;font-weight:700;color:#1a1a1a;margin-bottom:20px;letter-spacing:-0.02em}.archive-list{display:block;padding:0;margin:0;list-style:none}.archive-item{display:grid;grid-template-columns:140px 1fr;grid-template-areas:"date title";align-items:baseline;gap:20px;padding:16px 0;border-bottom:1px solid rgba(221,221,221,0.15)}.archive-item:last-child{border-bottom:none}.archive-date{grid-area:date;display:block;font-size:13px;font-weight:400;color:#777;letter-spacing:0.02em;white-space:nowrap}.archive-title{grid-area:title;display:inline-block;font-size:16px;font-weight:500;color:#1a1a1a;text-decoration:none; /* @alternate */ ;transition:-webkit-text-decoration 0.2s ease;transition:text-decoration 0.2s ease; /* @alternate */ ;transition:text-decoration 0.2s ease, -webkit-text-decoration 0.2s ease}.archive-title:hover{text-decoration:underline}.archive-emoji{display:inline-block;margin-left:6px;font-size:14px;opacity:0;transition:opacity 0.2s ease}.archive-item:hover .archive-emoji{opacity:1}.archive-tags{grid-area:tags;display:flex;gap:6px;flex-wrap:wrap;justify-content:flex-end}.archive-tag{display:inline-block;font-size:11px;font-weight:500;color:#777;text-decoration:none;text-transform:uppercase;letter-spacing:0.05em;transition:color 0.2s ease}.archive-tag:hover{color:#1a1a1a}@media all and (max-width: 767px){.archive-container{margin:0 0 20px 0}.archive-item{grid-template-columns:1fr;grid-template-areas:"date" "title";gap:4px;padding:12px 0}.archive-date{font-size:11px;text-transform:uppercase}.archive-title{font-size:15px}.archive-tags{justify-content:flex-start}.archive-tag{font-size:10px}.article-list-item a{position:relative;display:block;padding-left:0px;font-weight:400;font-size:1em;font-family:-apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;color:#1a1a1a}.article-list-footer{display:block;font-size:11px}.article-list-footer span{font-size:11px}.article-list-footer a{font-size:11px;color:#777}.article-list-divider{display:none}.article-list-tags{display:block;margin-top:4px;margin-left:0}.article-list-tags a{display:inline}}.embed-responsive{position:relative;display:block;height:0;padding:0;padding-bottom:75%;margin-bottom:30px;overflow:hidden}.embed-responsive iframe,.embed-responsive embed,.embed-responsive object,.embed-responsive video{position:absolute;top:0;bottom:0;left:0;width:100%;height:100%;border:0}.embed-responsive-16by9{padding-bottom:56.25%}.header-nav{position:fixed;top:0;left:0;right:0;background-color:#fff;z-index:1000;box-shadow:0 2px 4px rgba(0,0,0,0.1)}.header-nav-inner{max-width:720px;margin:0 auto;display:flex;justify-content:space-between;align-items:center;padding:20px 24px}main{padding-top:80px}.header-logo-container{position:relative;display:flex;align-items:center;gap:8px;top:auto;left:auto;z-index:100}.header-logo{display:block;font-family:-apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;font-size:1.5em;font-weight:700;color:#1a1a1a;text-decoration:none;margin-bottom:0}.header-divider{display:inline-block;color:#1a1a1a;font-size:1.2em}.header-emojis{display:flex;gap:8px}.header-emojis a{font-size:20px;text-decoration:none;transition:transform 0.2s ease}.header-emojis a:hover{transform:scale(1.2)}.header-icon{font-size:25px}.header-icon-link{text-decoration:none}.hash-icon-header{font-size:19px}.header-links{padding:0;margin:0;list-style:none;display:flex;align-items:center;gap:32px}.header-links li{display:inline-block;margin:0;vertical-align:middle}.header-links li a{font-size:16px;font-weight:500;color:#555;text-decoration:none;border-bottom:2px solid transparent;padding-bottom:2px;transition:border-color 0.2s linear}.header-links li a:hover{color:#000}.header-links li a.active{border-bottom-color:#555}.mobile-menu-toggle{display:none;flex-direction:column;justify-content:space-around;width:30px;height:25px;background:transparent;border:none;cursor:pointer;padding:0;z-index:1001}.mobile-menu-toggle .hamburger-line{width:30px;height:3px;background-color:#555;border-radius:2px;transition:all 0.3s ease;transform-origin:center}.mobile-menu-toggle.active .hamburger-line:nth-child(1){transform:translateY(8px) rotate(45deg)}.mobile-menu-toggle.active .hamburger-line:nth-child(2){opacity:0}.mobile-menu-toggle.active .hamburger-line:nth-child(3){transform:translateY(-8px) rotate(-45deg)}@media all and (max-width: 520px){.header-nav{padding:0}.header-nav-inner{padding:15px 24px;max-width:100%}.header-logo-container{gap:6px}.header-logo{font-size:1.2em}.header-divider{font-size:1em}.header-emojis{gap:4px}.header-emojis a{font-size:16px}.mobile-menu-toggle{display:flex}.header-links{position:fixed;top:60px;right:-100%;width:250px;height:calc(100vh - 60px);background-color:#fff;flex-direction:column;align-items:flex-start;gap:0;padding:20px;box-shadow:-2px 0 8px rgba(0,0,0,0.1);transition:right 0.3s ease}.header-links.active{right:0}.header-links li{width:100%;margin:0;padding:15px 0;border-bottom:1px solid rgba(128,128,128,0.2)}.header-links li:last-child{border-bottom:none}.header-links li a{display:inline-block;width:auto;font-size:18px}main{padding-top:100px}}@media all and (max-width: 767px){.header-nav{padding:0}.header-nav-inner{padding:15px 24px;max-width:100%}.mobile-menu-toggle{display:flex}.header-links{position:fixed;top:60px;right:-100%;width:250px;height:calc(100vh - 60px);background-color:#fff;flex-direction:column;align-items:flex-start;gap:0;padding:20px;box-shadow:-2px 0 8px rgba(0,0,0,0.1);transition:right 0.3s ease}.header-links.active{right:0}.header-links li{width:100%;margin:0;padding:15px 0;border-bottom:1px solid rgba(128,128,128,0.2)}.header-links li:last-child{border-bottom:none}.header-links li a{display:inline-block;width:auto;font-size:18px}main{padding-top:100px}}.highlight{padding:5px;margin:0;margin:0;overflow:auto;font-weight:400;background:#faf9f9;border-radius:4px}.highlight pre{margin:0}.highlighter-rouge{padding:4px 4px;font-size:16px;color:#121111;background:#faf9f9;border-radius:1px}@media all and (max-width: 767px){.highlight{padding:25px;font-size:16px}}.highlight .c{font-style:italic;color:#998}.highlight .err{color:#a61717;background-color:#e3d2d2}.highlight .k{font-weight:bold}.highlight .o{font-weight:bold}.highlight .cm{font-style:italic;color:#998}.highlight .cp{font-weight:bold;color:#999}.highlight .c1{font-style:italic;color:#998}.highlight .cs{font-style:italic;font-weight:bold;color:#999}.highlight .gd{color:#000;background-color:#fdd}.highlight .gd .x{color:#000;background-color:#faa}.highlight .ge{font-style:italic}.highlight .gr{color:#a00}.highlight .gh{color:#999}.highlight .gi{color:#000;background-color:#dfd}.highlight .gi .x{color:#000;background-color:#afa}.highlight .go{color:#888}.highlight .gp{color:#555}.highlight .gs{font-weight:bold}.highlight .gu{color:#aaa}.highlight .gt{color:#a00}.highlight .kc{font-weight:bold}.highlight .kd{font-weight:bold}.highlight .kp{font-weight:bold}.highlight .kr{font-weight:bold}.highlight .kt{font-weight:bold;color:#458}.highlight .m{color:#099}.highlight .s{color:#d14}.highlight .na{color:#008080}.highlight .nb{color:#0086b3}.highlight .nc{font-weight:bold;color:#458}.highlight .no{color:#008080}.highlight .ni{color:#800080}.highlight .ne{font-weight:bold;color:#900}.highlight .nf{font-weight:bold;color:#900}.highlight .nn{color:#555}.highlight .nt{color:#000080}.highlight .nv{color:#008080}.highlight .ow{font-weight:bold}.highlight .w{color:#bbb}.highlight .mf{color:#099}.highlight .mh{color:#099}.highlight .mi{color:#099}.highlight .mo{color:#099}.highlight .sb{color:#d14}.highlight .sc{color:#d14}.highlight .sd{color:#d14}.highlight .s2{color:#d14}.highlight .se{color:#d14}.highlight .sh{color:#d14}.highlight .si{color:#d14}.highlight .sx{color:#d14}.highlight .sr{color:#009926}.highlight .s1{color:#d14}.highlight .ss{color:#990073}.highlight .bp{color:#999}.highlight .vc{color:#008080}.highlight .vg{color:#008080}.highlight .vi{color:#008080}.highlight .il{color:#099}.appear{visibility:hidden;opacity:0}.appeared{visibility:visible;opacity:1;transition:opacity 0.5s ease-in-out}.tags-page-header{margin-top:0px}.tags-page{padding:50px 0}.tags-page h1{margin:0 0 15px 0}.tag-list{display:flex;flex-wrap:wrap;gap:12px;padding:0;margin:40px 0;list-style:none}.tag-list-item{display:inline-block}.tag-list-item a{position:relative;display:inline-flex;align-items:center;padding:8px 16px;padding-right:28px;text-decoration:none;font-weight:500;font-size:0.95em; /* @alternate */ ;transition:-webkit-text-decoration 0.2s ease;transition:text-decoration 0.2s ease; /* @alternate */ ;transition:text-decoration 0.2s ease, -webkit-text-decoration 0.2s ease}.tag-list-item a:hover{text-decoration:underline}.tag-count{position:absolute;top:4px;right:8px;font-weight:700;font-size:0.75em;color:#1a1a1a;opacity:0.7}@media all and (max-width: 767px){.tag-list{display:block;margin:20px 0}.tag-list-item{display:block;margin-bottom:16px}.tag-list-item a{display:inline;padding:0;background:none;border:none;border-radius:0;font-size:1em;font-weight:400;text-decoration:none}.tag-list-item a:hover{background:none;border:none;transform:none;box-shadow:none}.tag-count{position:static;margin-left:8px;font-size:0.9em;font-weight:400;opacity:0.5}}pre{margin-top:1.5rem;margin-bottom:1.5rem;background-color:#faf9f9;padding:16px 0;border-radius:16px}pre code{background-color:#faf9f9;font-family:monospace;display:block;padding:0 20px;color:#1b2733;font-size:14px;line-height:20px;overflow-x:auto;white-space:pre;word-spacing:normal;word-break:break-all}pre code .keyword{color:#ff5600}pre code .type{color:#718c00}pre code .call{color:#1b2733}pre code .property{color:#1b2733}pre code .number{color:#db6f57}pre code .string{color:#fd8273}pre code .comment{color:#6b8a94}pre code .dotAccess{color:#92b300}pre code .preprocessing{color:#fba15e}
/*# sourceMappingURL=/assets/source-maps/light.scss.map */
/*# sourceURL=_assets/stylesheets/light.scss */
</style>
    
  

  <!-- open graph metadata -->
<meta property="og:title" content="SwiftUI: View is not UIView">


<meta property="og:image" content="https://haoluo.io
">
<meta property="og:url" content="https://haoluo.ioamp/posts/swiftui-viewbody">
<meta property="og:description" content="And body is not setNeedsLayout.">
<meta property="profile:first_name" content="Hao">
<meta property="profile:last_name" content="Luo">
<meta property="og:site_name" content="Hao Luo">


  
    <meta property="og:type" content="article">
    <meta property="article:author" content="Hao Luo">
    <meta property="article:published_time" content="2020-09-07T00:00:00-04:00">
    
      <meta property="article:tag" content="ios">
    
      <meta property="article:tag" content="swift">
    
      <meta property="article:tag" content="tech">
    
  




<meta name="twitter:card" content="summary">
<meta name="twitter:url" content="https://haoluo.ioamp/posts/swiftui-viewbody">

<meta name="twitter:title" content="SwiftUI: View is not UIView">
<meta name="twitter:description" content="And body is not setNeedsLayout.">
<meta name="twitter:image" content="https://haoluo.io
">








  
    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>

    <script async custom-element="amp-analytics"
      src="https://cdn.ampproject.org/v0/amp-analytics-0.1.js"></script>
    <script async custom-element="amp-install-serviceworker"
      src="https://cdn.ampproject.org/v0/amp-install-serviceworker-0.1.js"></script>

    
    <!-- amp-youtube doesn't work -->
    
    
    

    <script async src="https://cdn.ampproject.org/v0.js"></script>

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>SwiftUI: View is not UIView | Hao Luo</title>
<meta name="generator" content="Jekyll v3.9.2" />
<meta property="og:title" content="SwiftUI: View is not UIView" />
<meta name="author" content="Hao Luo" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="And body is not setNeedsLayout." />
<meta property="og:description" content="And body is not setNeedsLayout." />
<link rel="canonical" href="/posts/swiftui-viewbody" />
<meta property="og:url" content="/posts/swiftui-viewbody" />
<meta property="og:site_name" content="Hao Luo" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-09-07T00:00:00-04:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="SwiftUI: View is not UIView" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Hao Luo"},"dateModified":"2025-10-02T19:41:50-04:00","datePublished":"2020-09-07T00:00:00-04:00","description":"And body is not setNeedsLayout.","headline":"SwiftUI: View is not UIView","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/swiftui-viewbody"},"url":"/posts/swiftui-viewbody"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>

  
    <amp-analytics config="https://www.googletagmanager.com/amp.json?id=&gtm.url=SOURCE_URL"
        data-credentials="include">
      <script type="application/json">
        {
          "vars": {
            "gaTrackingId": ""
          }
        }
        </script>
    </amp-analytics>
  

  <main>
    <div class="grid grid-centered">
      <div class="grid-cell">
        
        <nav class="header-nav">
  <div class="header-nav-inner">
    <div class="header-logo-container">
      <a href="/" class="header-logo" title="Hao Luo">
        Hao Luo
      </a>
      <span class="header-divider">|</span>
      <div class="header-emojis">
        <a href="https://run.haoluo.io/" title="Runner" target="_blank" rel="noopener noreferrer">üèÉüèª‚Äç‚ôÄÔ∏è</a>
        <a href="https://www.instagram.com/yvetterowe_/reels/" title="Vlogger" target="_blank" rel="noopener noreferrer">üé¨</a>
        <a href="https://www.linkedin.com/in/yvetterowe/" title="Builder" target="_blank" rel="noopener noreferrer">üë©üèª‚Äçüíª</a>
      </div>
    </div>
    <button class="mobile-menu-toggle" aria-label="Toggle navigation menu" aria-expanded="false">
      <span class="hamburger-line"></span>
      <span class="hamburger-line"></span>
      <span class="hamburger-line"></span>
    </button>
    <ul class="header-links">
      <li>
        <a href="/" title="Posts" class="active">Posts</a>
      </li>
      <li>
        <a href="/tags" title="Tags">Tags</a>
      </li>
      <li>
        <a href="/about" title="About">About</a>
      </li>
    </ul>
  </div>
</nav>


        
        <article class="article">
  <header class="article-header">
  <h1>SwiftUI: View is not UIView</h1>
  
  <p>And body is not setNeedsLayout.</p>
  <div class="article-list-footer">
    <span class="article-list-date">
      September 7, 2020
    </span>
    <div class="article-list-tags">
      
        
        
        
        <a href="/tag/ios">
          #IOS
        </a>
      
        
        
        
        <a href="/tag/swift">
          #SWIFT
        </a>
      
        
        
        
        <a href="/tag/tech">
          #TECH
        </a>
      
    </div>
  </div>
</header>
  <div class="article-content">
    
      <p>To deliver a smooth user experience with UIKit, we usually want to refresh the view only when it‚Äôs necessary instead of calling <code class="language-plaintext highlighter-rouge">setNeedsLayout</code>, <code class="language-plaintext highlighter-rouge">layoutIfNeeded</code> or <code class="language-plaintext highlighter-rouge">layoutSubviews</code> brainlessly. Same with SwiftUI, we also want to be mindful of view update performance.</p>

<p>SwiftUI has multiple ways to achieve the reactive-style data-driven UI update, eg. <code class="language-plaintext highlighter-rouge">State</code> for local state and <code class="language-plaintext highlighter-rouge">ObservedObject</code> for external data source. For example, suppose there‚Äôs an  <code class="language-plaintext highlighter-rouge">AvocadoView</code> that renders the number of avocado in the inventory, an <code class="language-plaintext highlighter-rouge">AvocadoStore</code> and an <code class="language-plaintext highlighter-rouge">AvocadoView</code> could be defined like this:</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">final</span> <span class="kd">class</span> <span class="kt">AvocadoStore</span><span class="p">:</span> <span class="kt">ObservableObject</span> <span class="p">{</span>
    <span class="kd">@Published</span> <span class="kd">private(set)</span> <span class="k">var</span> <span class="nv">avocadoCount</span><span class="p">:</span> <span class="kt">Int</span>
<span class="p">}</span>

<span class="kd">struct</span> <span class="kt">AvocadoView</span><span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="kd">@ObservedObject</span> <span class="k">var</span> <span class="nv">avocadoStore</span><span class="p">:</span> <span class="kt">AvocadoStore</span>

    <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"Refreshing ü•ë view"</span><span class="p">)</span>
        <span class="k">return</span> <span class="kt">Text</span><span class="p">(</span><span class="kt">String</span><span class="p">(</span><span class="nv">repeating</span><span class="p">:</span> <span class="s">"ü•ë"</span><span class="p">,</span> <span class="nv">count</span><span class="p">:</span> <span class="n">avocadoStore</span><span class="o">.</span><span class="n">avocadoCount</span><span class="p">))</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>It‚Äôs summertime, let‚Äôs get some peaches üçë as well. In practice, they probably live together with avocados in the same store.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">final</span> <span class="kd">class</span> <span class="kt">FruitStore</span><span class="p">:</span> <span class="kt">ObservableObject</span> <span class="p">{</span>
    <span class="kd">@Published</span> <span class="kd">private(set)</span> <span class="k">var</span> <span class="nv">avocadoCount</span><span class="p">:</span> <span class="kt">Int</span>
    <span class="kd">@Published</span> <span class="kd">private(set)</span> <span class="k">var</span> <span class="nv">peachCount</span><span class="p">:</span> <span class="kt">Int</span>
<span class="p">}</span>

<span class="kd">struct</span> <span class="kt">AvocadoView</span><span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="kd">@ObservedObject</span> <span class="k">var</span> <span class="nv">fruitStore</span><span class="p">:</span> <span class="kt">FruitStore</span>

    <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"Refreshing ü•ë view"</span><span class="p">)</span>
        <span class="k">return</span> <span class="kt">Text</span><span class="p">(</span><span class="kt">String</span><span class="p">(</span><span class="nv">repeating</span><span class="p">:</span> <span class="s">"ü•ë"</span><span class="p">,</span> <span class="nv">count</span><span class="p">:</span> <span class="n">fruitStore</span><span class="o">.</span><span class="n">avocadoCount</span><span class="p">))</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Then here comes an interesting problem with <code class="language-plaintext highlighter-rouge">ObservableObject</code> and <code class="language-plaintext highlighter-rouge">@Published</code> property wrapper. Suppose someone steals the peaches, which causes <code class="language-plaintext highlighter-rouge">FruitStore</code> to publish a new value of  <code class="language-plaintext highlighter-rouge">peachCount</code>. Should  <code class="language-plaintext highlighter-rouge">AvocadoView</code> be affected in this case? Ideally not. But in reality, I found that the <code class="language-plaintext highlighter-rouge">body</code> of <code class="language-plaintext highlighter-rouge">AvocadoView</code> is indeed re-constructed (‚ÄúRefreshing ü•ë view‚Äù is logged). This is because <code class="language-plaintext highlighter-rouge">AvocadoView</code> observes on the whole <code class="language-plaintext highlighter-rouge">FruitStore</code>, which makes it re-flow its body as long as any of store‚Äôs <code class="language-plaintext highlighter-rouge">@Published</code> property gets updated (aka. ‚Äúpublished‚Äù) - even though only <code class="language-plaintext highlighter-rouge">avocadoCount</code> is referenced in <code class="language-plaintext highlighter-rouge">body</code>.</p>

<p>Hmm, this is not good. We should probably embrace <em>Single-responsibility principle</em> here to make <code class="language-plaintext highlighter-rouge">AvocadoView</code> only observe on <code class="language-plaintext highlighter-rouge">avocadoCount</code>, the data it cares about. In practice, <code class="language-plaintext highlighter-rouge">FruitStore</code> probably still has to exist to serve some aggregation functionality, or it could simply be it‚Äôs already a GOD hairball object that‚Äôs basically impossible to break down easily (yea you know what I‚Äôm talking about don‚Äôt you üåö). But fortunately enough:</p>

<blockquote>
  <p>We can solve any problem by introducing an extra level of indirection.</p>
</blockquote>

<p>So I followed the calling by introducing a small and sweet  <code class="language-plaintext highlighter-rouge">AvocadoStore</code>:</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">final</span> <span class="kd">class</span> <span class="kt">AvocadoStore</span><span class="p">:</span> <span class="kt">ObservableObject</span> <span class="p">{</span>
    <span class="kd">@Published</span> <span class="kd">private(set)</span> <span class="k">var</span> <span class="nv">avocadoCount</span><span class="p">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="kd">private</span> <span class="k">var</span> <span class="nv">cancellable</span><span class="p">:</span> <span class="kt">AnyCancellable</span><span class="o">!</span>

    <span class="nf">init</span><span class="p">(</span><span class="nv">fruitStore</span><span class="p">:</span> <span class="kt">FruitStore</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">cancellable</span> <span class="o">=</span> <span class="n">fruitStore</span><span class="o">.</span><span class="err">$</span><span class="n">avocadoCount</span>
            <span class="o">.</span><span class="n">sink</span> <span class="p">{</span> <span class="n">avocadoCountInFruitStore</span> <span class="k">in</span>
            <span class="k">self</span><span class="o">.</span><span class="n">avocadoCount</span> <span class="o">=</span> <span class="n">avocadoCountInFruitStore</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">struct</span> <span class="kt">AvocadoView</span><span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="kd">@ObservedObject</span> <span class="k">var</span> <span class="nv">avocadoStore</span><span class="p">:</span> <span class="kt">AvocadoStore</span>

    <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"Refreshing ü•ë view"</span><span class="p">)</span>
        <span class="k">return</span> <span class="kt">Text</span><span class="p">(</span><span class="kt">String</span><span class="p">(</span><span class="nv">repeating</span><span class="p">:</span> <span class="s">"ü•ë"</span><span class="p">,</span> <span class="nv">count</span><span class="p">:</span> <span class="n">avocadoStore</span><span class="o">.</span><span class="n">avocadoCount</span><span class="p">))</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>What <code class="language-plaintext highlighter-rouge">AvocadoStore</code> basically does is to bridge <code class="language-plaintext highlighter-rouge">FruitStore</code> and <code class="language-plaintext highlighter-rouge">AvocadoView</code> while preventing <code class="language-plaintext highlighter-rouge">AvocadoView</code> from being exposed to irrelevant noise (<code class="language-plaintext highlighter-rouge">peachCount</code> in our case). This all sounds right‚Ä¶but do we really need it?</p>

<p>I was deriving all my solutions so far based on an assumption: a <code class="language-plaintext highlighter-rouge">View</code> is like a <code class="language-plaintext highlighter-rouge">UIView</code> - and calling <code class="language-plaintext highlighter-rouge">body</code> is like calling <code class="language-plaintext highlighter-rouge">setNeedsLayout</code> or <code class="language-plaintext highlighter-rouge">layoutSubviews</code>, which eventually leads to a view refresh. But the assumption is <em>wrong</em>, and it is exactly the major difference between SwiftUI and UIKit - the declarative and the imperative. In SwiftUI, <code class="language-plaintext highlighter-rouge">View</code> is a <code class="language-plaintext highlighter-rouge">struct</code> value type used to <em>describe</em> a view‚Äôs content and behavior - it‚Äôs not the view itself. And that‚Äôs it, the SwiftUI infrastructure will take care of the heavy lifting. In our original implementation, it‚Äôs true that <code class="language-plaintext highlighter-rouge">AvocadoView</code> ‚Äôs <code class="language-plaintext highlighter-rouge">body</code> gets called whenever <code class="language-plaintext highlighter-rouge">fruitStore.peachCount</code> is updated - but it‚Äôs also true that it gets called with the same <code class="language-plaintext highlighter-rouge">fruitStore.avocadoCount</code> value each time. The SwiftUI infra will be smart enough to process these <code class="language-plaintext highlighter-rouge">body</code> update messages and figure out what to do: ‚ÄúLast time it says there are X avocados, this time it‚Äôs still X. Nothing changes, just sit back and chill.‚Äù</p>

<p>Don‚Äôt get me wrong - I‚Äôm not saying introducing <code class="language-plaintext highlighter-rouge">AvocadoStore</code> is completely worthless here. From the API design and dependency management perspective, it still makes a lot of sense - like how we use thin protocols to break down a fat class. It‚Äôs just the goal is not to correct a <em>fundamental fault</em> anymore. Bringing in a layer of indirection reduces coupling but could also fall part when it over complicates things - and that‚Äôs the tradeoff we need to make in production codebase at scale, case-by-case.</p>

    
  </div>
  <div class="article-pagination">
  
  
</div>

  
</article>


  
    
<script type="application/ld+json">
{
   "@context":"http://schema.org",
   "@type":"BlogPosting",
   "headline":"SwiftUI: View is not UIView",
   "keywords":"ios, swift, tech",
   "wordCount":"680",
   "url":"https://haoluo.ioamp/posts/swiftui-viewbody",
   "datePublished":"2020-09-07",
   "dateModified":"2025-10-02",
   "author": {
    "@context": "http://schema.org",
    "@type": "Person",
    "url": "http://haoluo.io"
}
,
   "publisher": {
      "@type": "Organization",
      "name": "Hao Luo",
      "logo": {
        "@type": "ImageObject",
      }
    },
    "image":"https://haoluo.io
",
    "mainEntityOfPage":{
      "@type":"WebPage",
      "@id":"https://haoluo.ioamp/posts/swiftui-viewbody"
    },
    "articleBody":"To deliver a smooth user experience with UIKit, we usually want to refresh the view only when it‚Äôs necessary instead of calling setNeedsLayout, layoutIfNeeded or layoutSubviews brainlessly. Same with SwiftUI, we also want to be mindful of view update performance.SwiftUI has multiple ways to achieve the reactive-style data-driven UI update, eg. State for local state and ObservedObject for external data source. For example, suppose there‚Äôs an  AvocadoView that renders the number of avocado in the inventory, an AvocadoStore and an AvocadoView could be defined like this:final class AvocadoStore: ObservableObject {    @Published private(set) var avocadoCount: Int}struct AvocadoView: View {    @ObservedObject var avocadoStore: AvocadoStore    var body: some View {        print(&quot;Refreshing ü•ë view&quot;)        return Text(String(repeating: &quot;ü•ë&quot;, count: avocadoStore.avocadoCount))    }}It‚Äôs summertime, let‚Äôs get some peaches üçë as well. In practice, they probably live together with avocados in the same store.final class FruitStore: ObservableObject {    @Published private(set) var avocadoCount: Int    @Published private(set) var peachCount: Int}struct AvocadoView: View {    @ObservedObject var fruitStore: FruitStore    var body: some View {        print(&quot;Refreshing ü•ë view&quot;)        return Text(String(repeating: &quot;ü•ë&quot;, count: fruitStore.avocadoCount))    }}Then here comes an interesting problem with ObservableObject and @Published property wrapper. Suppose someone steals the peaches, which causes FruitStore to publish a new value of  peachCount. Should  AvocadoView be affected in this case? Ideally not. But in reality, I found that the body of AvocadoView is indeed re-constructed (‚ÄúRefreshing ü•ë view‚Äù is logged). This is because AvocadoView observes on the whole FruitStore, which makes it re-flow its body as long as any of store‚Äôs @Published property gets updated (aka. ‚Äúpublished‚Äù) - even though only avocadoCount is referenced in body.Hmm, this is not good. We should probably embrace Single-responsibility principle here to make AvocadoView only observe on avocadoCount, the data it cares about. In practice, FruitStore probably still has to exist to serve some aggregation functionality, or it could simply be it‚Äôs already a GOD hairball object that‚Äôs basically impossible to break down easily (yea you know what I‚Äôm talking about don‚Äôt you üåö). But fortunately enough:  We can solve any problem by introducing an extra level of indirection.So I followed the calling by introducing a small and sweet  AvocadoStore:final class AvocadoStore: ObservableObject {    @Published private(set) var avocadoCount: Int = 0    private var cancellable: AnyCancellable!    init(fruitStore: FruitStore) {        cancellable = fruitStore.$avocadoCount            .sink { avocadoCountInFruitStore in            self.avocadoCount = avocadoCountInFruitStore        }    }}struct AvocadoView: View {    @ObservedObject var avocadoStore: AvocadoStore    var body: some View {        print(&quot;Refreshing ü•ë view&quot;)        return Text(String(repeating: &quot;ü•ë&quot;, count: avocadoStore.avocadoCount))    }}What AvocadoStore basically does is to bridge FruitStore and AvocadoView while preventing AvocadoView from being exposed to irrelevant noise (peachCount in our case). This all sounds right‚Ä¶but do we really need it?I was deriving all my solutions so far based on an assumption: a View is like a UIView - and calling body is like calling setNeedsLayout or layoutSubviews, which eventually leads to a view refresh. But the assumption is wrong, and it is exactly the major difference between SwiftUI and UIKit - the declarative and the imperative. In SwiftUI, View is a struct value type used to describe a view‚Äôs content and behavior - it‚Äôs not the view itself. And that‚Äôs it, the SwiftUI infrastructure will take care of the heavy lifting. In our original implementation, it‚Äôs true that AvocadoView ‚Äôs body gets called whenever fruitStore.peachCount is updated - but it‚Äôs also true that it gets called with the same fruitStore.avocadoCount value each time. The SwiftUI infra will be smart enough to process these body update messages and figure out what to do: ‚ÄúLast time it says there are X avocados, this time it‚Äôs still X. Nothing changes, just sit back and chill.‚ÄùDon‚Äôt get me wrong - I‚Äôm not saying introducing AvocadoStore is completely worthless here. From the API design and dependency management perspective, it still makes a lot of sense - like how we use thin protocols to break down a fat class. It‚Äôs just the goal is not to correct a fundamental fault anymore. Bringing in a layer of indirection reduces coupling but could also fall part when it over complicates things - and that‚Äôs the tradeoff we need to make in production codebase at scale, case-by-case."
}
</script>
<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [{
      "@type": "ListItem",
      "position": 1,
      "item": {
        "@id": "https://haoluo.io/about",
        "name": "Hao Luo"
      }
    }, {
      "@type": "ListItem",
      "position": 2,
      "item": {
        "@id": "https://haoluo.io",
        "name": "Posts"
      }
    }, {
      "@type": "ListItem",
      "position": 3,
      "item": {
        "@id": "https://haoluo.ioamp/posts/swiftui-viewbody",
        "name": "SwiftUI: View is not UIView",
        "image": "https://haoluo.io
"
      }
    }]
  }
</script>
  




        
        <footer class="footer">
  <p>
    ¬© 2025 <a href="https://haoluo.io/" rel="noopener noreferrer" target="_blank" title="Hao Luo">Hao Luo</a> Kudos to
    <a href="https://github.com/jekyll/jekyll" rel="noopener noreferrer" target="_blank" title="Jekyll" aria-label="Jekyll - Generator">Jekyll</a>
    &amp;
    <a target="_blank" href="https://github.com/nielsenramon/chalk" rel="noopener noreferrer" title="Chalk" aria-label="Chalk - Theme">Chalk</a>
  </p>

  <!-- Fathom - simple website analytics - https://usefathom.com -->
  <script>
  (function(f, a, t, h, o, m){
  a[h]=a[h]||function(){
  (a[h].q=a[h].q||[]).push(arguments)
  };
  o=f.createElement('script'),
  m=f.getElementsByTagName('script')[0];
  o.async=1; o.src=t; o.id='fathom-script';
  m.parentNode.insertBefore(o,m)
  })(document, window, 'https://cdn.usefathom.com/tracker.js', 'fathom');
  fathom('set', 'siteId', 'HIYTKGPC');
  fathom('trackPageview');
  </script>
  <!-- / Fathom -->
</footer>

      </div>
    </div>
  </main>

  
  
  <amp-install-serviceworker
    src="https://haoluo.io/assets/sw.js"
    layout="nodisplay"></amp-install-serviceworker>


</body>
</html>
